# 要求定義書 - 開発環境セットアップ

## 1. 変更・追加する機能の説明

本作業では、開発者が即座にプロジェクトの開発を開始できるよう、以下2つの開発環境を構築します。

### 1.1 Python開発環境の構築
Lambda関数（Pythonアプリケーション）の開発に必要な環境を整備します。
- devcontainer設定ファイルの作成
- Python 3.12環境の構築
- 依存関係管理ツール（uv）のセットアップ
- 開発ツール（Ruff、mypy）の設定
- VS Code拡張機能の設定

### 1.2 CDKデプロイ環境の構築
AWS CDKによるインフラストラクチャのデプロイが可能な環境を整備します。
- devcontainer設定ファイルの作成
- Node.js 20環境の構築
- AWS CLI v2のインストール
- AWS CDKのセットアップ
- VS Code拡張機能の設定

## 2. ユーザーストーリー

### US-DEV-001: Python開発環境の利用
```
開発者として、
VS CodeでPythonアプリケーションを開発したい。
なぜなら、一貫した開発環境でLambda関数の実装・テストを行いたいから。
```

### US-DEV-002: CDKデプロイ環境の利用
```
開発者として、
ローカル環境からAWSインフラをデプロイしたい。
なぜなら、インフラ変更を迅速に反映し、動作確認を行いたいから。
```

### US-DEV-003: 環境の分離
```
開発者として、
Python開発とCDK開発を独立した環境で行いたい。
なぜなら、それぞれの環境が干渉せず、クリーンな状態を保ちたいから。
```

## 3. 受け入れ条件

### AC-DEV-001: Python開発環境
- [ ] `app/.devcontainer/`配下にdevcontainer設定ファイルが存在する
- [ ] VS Codeで`app/`ディレクトリを開き、「Reopen in Container」が実行できる
- [ ] コンテナ内でPython 3.12が利用可能である
- [ ] `uv`コマンドが利用可能である
- [ ] `ruff`によるlint・formatが実行できる
- [ ] `mypy`による型チェックが実行できる
- [ ] `pytest`によるテストが実行できる
- [ ] VS Code拡張機能（Python、Pylance、Ruff、mypy Type Checker）が自動インストールされる

### AC-DEV-002: CDKデプロイ環境
- [ ] `cdk/.devcontainer/`配下にdevcontainer設定ファイルが存在する
- [ ] VS Codeで`cdk/`ディレクトリを開き、「Reopen in Container」が実行できる
- [ ] コンテナ内でNode.js 20が利用可能である
- [ ] `aws`コマンド（AWS CLI v2）が利用可能である
- [ ] `cdk`コマンド（AWS CDK）がグローバルインストールされている
- [ ] `npm`による依存関係のインストールが実行できる
- [ ] `cdk synth`による合成が実行できる
- [ ] `cdk deploy`によるデプロイが実行できる（AWS認証設定後）
- [ ] VS Code拡張機能（ESLint、Prettier、AWS Toolkit）が自動インストールされる

### AC-DEV-003: ドキュメント整備
- [ ] 開発環境のセットアップ手順が明確である
- [ ] 各環境の使い分けが理解できる
- [ ] トラブルシューティング情報が含まれる

## 4. 制約事項

### 4.1 技術的制約
- Docker Desktopまたは互換ツール（Rancher Desktop、OrbStack等）がホストマシンにインストールされている必要がある
- VS Codeの「Dev Containers」拡張機能がインストールされている必要がある
- AWSへのデプロイには、AWS認証情報（IAMユーザーまたはIAM Identity Center）の設定が必要である

### 4.2 環境的制約
- devcontainerはDocker環境で動作するため、ホストマシンのリソース（CPU、メモリ）を消費する
- 初回のコンテナビルドには時間がかかる場合がある

### 4.3 運用上の制約
- Python環境とCDK環境は独立しているため、VS Codeで開くディレクトリを切り替える必要がある
- 依存関係の更新時は、コンテナの再ビルドが必要になる場合がある

## 5. 対象外事項

以下は本作業のスコープ外とします。
- CI/CD環境の構築（GitHub Actionsワークフローの作成）
- 実際のAWSリソースのデプロイ
- アプリケーションコードの実装
- テストコードの実装
- AWS認証情報の設定手順（別途ドキュメント化を推奨）
