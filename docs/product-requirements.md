# プロダクト要求定義書（Product Requirements Document）

## 1. プロダクトビジョンと目的

### 1.1 ビジョン
日本全国のユーザーが、毎朝の準備時に自分の地域の「実質的な天気情報」を簡単に把握できるようにし、日々の外出準備をサポートする。

### 1.2 目的
- ユーザーが必要な地域の天気情報を自動で受け取れるようにする
- 「実質の気温」と「実質の降水確率」という実用的な情報を提供する
- LINE という日常的に使用するプラットフォームを活用し、情報取得の手間を最小化する

### 1.3 解決する課題
- yahoo天気などの一般的な天気予報アプリでは、「実質の天気がわからない」
- 「実質の天気」とは、人間が行動する時間帯での最高・最低気温や降水確率のこと
- 例えば、前日は気温が高く今日が気温が低い場合、0:00付近が最高気温になってしまい、人間の行動時間に即していない問題がある

## 2. 主要な機能一覧

| 機能ID | 機能名 | 概要 |
|--------|--------|------|
| F-001 | 地域設定機能 | ユーザーがLINE BOTを通じて通知対象の地域を設定・変更できる |
| F-002 | 天気配信機能 | 毎日9時に、ユーザーが設定した地域の天気情報を自動配信する |

## 3. 成功の定義

- ユーザーが毎朝の天気確認を習慣化できている
- 配信される情報が実用的で役立つと感じられている

## 4. ビジネス要件

### 4.1 ターゲットユーザー
- 日本国内に居住する個人
- LINEを日常的に利用している人
- 毎朝の天気情報を効率的に取得したい人

### 4.2 運用要件
- 毎日9:00に確実に配信が完了すること
- システムダウンタイムを最小限に抑えること
- 天気情報の取得元APIの信頼性を確保すること

## 5. ユーザーストーリー

### US-001: 地域設定
```
ユーザーとして、
LINE BOTに通知してほしい地域を設定したい。
なぜなら、自分が知りたい地域の天気情報だけを受け取りたいから。
```

### US-002: 地域変更
```
ユーザーとして、
設定した地域を後から変更したい。
なぜなら、引っ越しや出張などで必要な地域が変わることがあるから。
```

### US-003: 天気情報の受信
```
ユーザーとして、
毎朝9時に設定した地域の天気情報を受け取りたい。
なぜなら、その日の服装や持ち物を決める参考にしたいから。
```

### US-004: 現在の設定確認
```
ユーザーとして、
現在設定している地域を確認したい。
なぜなら、正しい地域が設定されているか把握したいから。
```

## 6. 受け入れ条件

### AC-001: 地域設定機能
- [ ] ユーザーがLINE BOTに対してメッセージを送ることで地域を設定できる
- [ ] 日本全国の主要地域（都道府県単位または市区町村単位）から選択できる
- [ ] 設定完了時に確認メッセージが返信される
- [ ] 無効な地域名を入力した場合、エラーメッセージと正しい入力方法が案内される

### AC-002: 地域変更機能
- [ ] 既に設定済みのユーザーが再度地域を設定した場合、上書き更新される
- [ ] 変更完了時に新しい設定内容が確認メッセージとして返信される

### AC-003: 天気配信機能
- [ ] 毎日9:00（JST）に配信処理が開始される
- [ ] 地域設定済みの全ユーザーに対して配信される
- [ ] 配信内容には「実質の気温」と「実質の降水確率」が含まれる
- [ ] 配信対象時間帯は9:00〜23:00とする

### AC-004: 設定確認機能
- [ ] ユーザーが現在の設定を確認するコマンドを送信できる
- [ ] 現在設定されている地域名が返信される
- [ ] 未設定の場合は、その旨と設定方法が案内される

## 7. 機能要件

### 7.1 地域設定機能（F-001）

#### 7.1.1 対象地域
- 日本全国の都道府県を対象とする
- 将来的に市区町村単位への拡張を考慮する

#### 7.1.2 設定方法
- ユーザーがLINE BOTにメッセージを送信することで設定
- 例: 「東京」「大阪」などの地域名を送信

#### 7.1.3 データ保持
- ユーザーごとに設定した地域を保存
- LINE User IDと地域の紐付けを管理

### 7.2 天気配信機能（F-002）

#### 7.2.1 配信タイミング
- 毎日9:00（JST）に配信

#### 7.2.2 配信内容
- 対象日: 当日
- 対象時間帯: 9:00〜23:00
- 配信情報:
  - 実質の気温（体感温度を考慮した気温）
  - 実質の降水確率（時間帯ごとの降水確率を考慮した実用的な数値）

#### 7.2.3 配信形式
- LINEメッセージ形式
- 視認性の高いフォーマットで表示

## 8. 非機能要件

### 8.1 可用性
- 配信処理の成功率: 99%以上
- システム全体の稼働率: 99%以上

### 8.2 性能
- 全ユーザーへの配信完了: 9:00〜9:30の間に完了
- 地域設定操作のレスポンス: 3秒以内

### 8.3 セキュリティ
- ユーザーの個人情報（LINE User ID）の適切な管理
- 通信の暗号化（HTTPS）
- 不正アクセス対策

### 8.4 拡張性
- ユーザー数増加に対応できるスケーラブルな設計
- 将来的な機能追加に対応できるアーキテクチャ

### 8.5 保守性
- ログの適切な出力と監視
- エラー発生時のアラート機能
- デプロイの自動化

## 9. 制約事項

### 9.1 技術的制約
- LINE Messaging APIの仕様に準拠する必要がある
- 天気情報取得元APIの利用規約に従う

### 9.2 運用上の制約
- LINE BOTの月間メッセージ送信数の上限を考慮
- 天気情報APIの呼び出し回数制限を考慮

## 10. 今後の拡張候補（スコープ外）

以下は初期リリースには含めないが、将来的な拡張として検討する機能:
- 複数地域の登録
- 配信時刻のカスタマイズ
- 週間天気予報の配信
- 警報・注意報のプッシュ通知
- 天気に応じた服装アドバイス
